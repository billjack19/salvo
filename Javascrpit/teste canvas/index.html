<html>
<head>
	<meta charset="utf-8">
	<title>Teste Canvas</title>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
</head>
<body>
	<canvas id="canvas" width="800" height="200"></canvas>

	<script>
		/* variaveis */
		var cnv = document.getElementById("canvas"), 
		ctx = cnv.getContext("2d");

		displayEscala = {
			cordenadas: [],
			cor: "",

			definirCor: function(){
				/* cor gradiente ( vermelho | amarelo | verde | amarelo | vermelho ) */
				this.cor = ctx.createLinearGradient(50, 50, 195, 50);
				this.cor.addColorStop(0,	"red"		);
				this.cor.addColorStop(0.4,	"yellow"	);
				this.cor.addColorStop(0.5,	"green"		);
				this.cor.addColorStop(0.6,	"yellow"	);
				this.cor.addColorStop(1,	"red"		);
			},

			tracarCordenadas: function(){
				this.cordenadas.push({type:"moveTo", 			x: 50,  y: 50							});
				this.cordenadas.push({type:"lineTo", 			x: 100, y: 150							});
				this.cordenadas.push({type:"quadraticCurveTo", 	x: 150, y: 150, quadX: 125, quadY: 130	});
				this.cordenadas.push({type:"lineTo",  			x: 200, y: 50							});
				this.cordenadas.push({type:"quadraticCurveTo", 	x: 50,  y: 50,  quadX: 125, quadY: 5	});
			},

			desenhar: function(){
				for (var i = 0; i < this.cordenadas.length; i++) {
					if (i == 0) moveTo(this.cordenadas[i].x, this.cordenadas[i].y);
					switch(this.cordenadas[i].type){
						case "moveTo": 				ctx.moveTo(this.cordenadas[i].x, this.cordenadas[i].y); break;
						case "lineTo": 				ctx.lineTo(this.cordenadas[i].x, this.cordenadas[i].y); break;
						case "quadraticCurveTo": 	ctx.quadraticCurveTo(this.cordenadas[i].quadX, this.cordenadas[i].quadY, this.cordenadas[i].x, this.cordenadas[i].y); break;
					}
				}
			}
		},

		ponteiro = {
			x: 250,
			y: 50,
			largura: 2,
			altura: 90,
			cor: "#000"
		}

		cnv.style.border = "1px solid #000";

		/* escala */
		ctx.beginPath();
		ctx.moveTo(50, 50);
		ctx.lineTo(100, 150);
		ctx.quadraticCurveTo(125, 130, 150, 150);
		ctx.lineTo(200, 50);
		ctx.quadraticCurveTo(125, 5, 50, 50);

		var my_gradient = ctx.createLinearGradient(50, 50, 195, 50);

		// var my_gradient = ctx.createRadialGradient(50, 50, 195, 50);

		my_gradient.addColorStop(0,		"red");
		my_gradient.addColorStop(0.4,	"yellow");
		// my_gradient.addColorStop(0.35,	"yellow");
		my_gradient.addColorStop(0.5,	"green");
		// my_gradient.addColorStop(0.55,	"green");
		// my_gradient.addColorStop(0.65,	"yellow");
		my_gradient.addColorStop(0.6,	"yellow");
		my_gradient.addColorStop(1,		"red");

		ctx.fillStyle = my_gradient; // "red";
		ctx.fill();
		ctx.closePath();
		ctx.stroke();

		/* ponteiro */
		ctx.beginPath();
		ctx.moveTo(125, 140);
		ctx.lineTo(90, 50);
		// ctx.rotate(20*Math.PI/180);
		// ctx.fillRect(250,50,2,90);
		// ctx.fillStyle = "black";
		// ctx.fill();
		ctx.stroke();

		cnv.addEventListener("mousedown", function(e){
			var mouseX = e.pageX - this.offsetLeft;
			var mouseY = e.pageY - this.offsetTop;

			paint = true;
			addClick(e.pageX - this.offsetLeft, e.pageY - this.offsetTop);
			redraw();
		});

		/*document.getElementById('canvas').mousedown(function(e){
		  var mouseX = e.pageX - this.offsetLeft;
		  var mouseY = e.pageY - this.offsetTop;
				
		  paint = true;
		  addClick(e.pageX - this.offsetLeft, e.pageY - this.offsetTop);
		  redraw();
		});*/

		cnv.addEventListener("mousemove", function(e){
			if(paint){
				addClick(e.pageX - this.offsetLeft, e.pageY - this.offsetTop, true);
				redraw();
			}
		});

		cnv.addEventListener("mouseup", function(e){ paint = false; });
		cnv.addEventListener("mouseleave", function(e){ paint = false; });

		var clickX = new Array();
		var clickY = new Array();
		var clickDrag = new Array();
		var paint;

		function addClick(x, y, dragging)
		{
			clickX.push(x);
			clickY.push(y);
			clickDrag.push(dragging);
		}

		function redraw(){
			ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height); // Clears the canvas

			ctx.strokeStyle = "#df4b26";
			ctx.lineJoin = "round";
			ctx.lineWidth = 5;

			for(var i=0; i < clickX.length; i++) {		
				ctx.beginPath();
				if(clickDrag[i] && i){  ctx.moveTo(clickX[i-1], clickY[i-1]); 	}
				else { 					ctx.moveTo(clickX[i]-1, clickY[i]);  	}
				ctx.lineTo(clickX[i], clickY[i]);
				ctx.closePath();
				ctx.stroke();
			}
		}
	</script>
</body>
</html>