/*
 * Facebox (for jQuery)
 * version: 1.2 (05/05/2008)
 * @requires jQuery v1.2 or later
 * Examples at http://famspam.com/facebox/
 * Licensed under the MIT: http://www.opensource.org/licenses/mit-license.php
 * Copyright 2007, 2008 Chris Wanstrath [ chris@ozmm.org ]
 */
 
(function(a){function e(b){if(a.facebox.settings.inited)return!0;a.facebox.settings.inited=!0;a(document).trigger("init.facebox");m();var c=a.facebox.settings.imageTypes.join("|");a.facebox.settings.imageTypesRegexp=new RegExp("."+c+"$","i");b&&a.extend(a.facebox.settings,b);a("body").append(a.facebox.settings.faceboxHtml);a(".facebox_clsImage").css("backgroundImage");var d=[new Image,new Image];d[0].src=a.facebox.settings.closeImage;d[1].src=a.facebox.settings.loadingImage;a("#facebox").find(".b:first, .bl, .br, .tl, .tr").each(function(){d.push(new Image);
d.slice(-1).src=a(this).css("background-image").replace(/url\((.+)\)/,"$1")});a("#facebox .facebox_close").click(a.facebox.close);a("#facebox .facebox_close_image").attr("src",a.facebox.settings.closeImage)}function f(){var a,c;self.pageYOffset?(c=self.pageYOffset,a=self.pageXOffset):document.documentElement&&document.documentElement.scrollTop?(c=document.documentElement.scrollTop,a=document.documentElement.scrollLeft):document.body&&(c=document.body.scrollTop,a=document.body.scrollLeft);return[a,
c]}function n(){var a;self.innerHeight?a=self.innerHeight:document.documentElement&&document.documentElement.clientHeight?a=document.documentElement.clientHeight:document.body&&(a=document.body.clientHeight);return a}function m(){var b=a.facebox.settings;b.loadingImage=b.loading_image||b.loadingImage;b.closeImage=b.close_image||b.closeImage;b.imageTypes=b.image_types||b.imageTypes;b.faceboxHtml=b.facebox_html||b.faceboxHtml}function g(b,c){if(b.match(/#/)){var d=window.location.href.split("#")[0],
d=b.replace(d,"");a.facebox.reveal(a(d).clone().show(),c)}else b.match(a.facebox.settings.imageTypesRegexp)?h(b,c):k(b,c)}function h(b,c){var d=new Image;d.onload=function(){a.facebox.reveal('<div class="facebox_image"><img src="'+d.src+'" /></div>',c)};d.src=b}function k(b,c){a.get(b,function(b){a.facebox.reveal(b,c)})}function l(){return 0==a.facebox.settings.overlay||null===a.facebox.settings.opacity}function p(){if(!l())return 0==a("facebox_overlay").length&&a("body").append('<div id="facebox_overlay" class="facebox_hide"></div>'),
a("#facebox_overlay").hide().addClass("facebox_overlayBG").css("opacity",a.facebox.settings.opacity).click(function(){a(document).trigger("close.facebox")}).fadeIn(200),!1}function q(){if(!l())return a("#facebox_overlay").fadeOut(200,function(){a("#facebox_overlay").removeClass("facebox_overlayBG");a("#facebox_overlay").addClass("facebox_hide");a("#facebox_overlay").remove()}),!1}a.facebox=function(b,c){a.facebox.loading();b.ajax?k(b.ajax):b.image?h(b.image):b.div?g(b.div):a.isFunction(b)?b.call(a):
a.facebox.reveal(b,c)};a.extend(a.facebox,{settings:{opacity:0,overlay:!0,loadingImage:"/js/facebox/images/loading.gif",closeImage:"/js/facebox/images/closelabel.gif",imageTypes:["png","jpg","jpeg","gif"],faceboxHtml:'<div id="facebox" style="display:none;"><div class="facebox_popup"><table><tbody><tr><td class="facebox_tl"/><td class="facebox_b"/><td class="facebox_tr"/></tr><tr><td class="facebox_b"><td class="facebox_body"><div class="facebox_content"></div><div class="facebox_footer"><a href="#" class="facebox_close"><img class="facebox_close_image" src="/axZm/plugins/facebox/images/closelabel.gif" title="close"></a></div><div class="facebox_clsImage"></div></td><td class="facebox_b"></tr><tr><td class="facebox_bl"/><td class="facebox_b"/><td class="facebox_br"/></tr></tbody></table></div></div>'},
loading:function(){e();if(1==a("#facebox .facebox_loading").length)return!0;p();a("#facebox .facebox_content").empty();a("#facebox .facebox_body").children().hide().end().append('<div class="facebox_loading"><img src="'+a.facebox.settings.loadingImage+'"/></div>');a("#facebox").css({top:f()[1]+n()/10,left:a(window).width()/2-205}).show();a(document).bind("keydown.facebox",function(b){27==b.keyCode&&a.facebox.close();return!0});a(document).trigger("loading.facebox")},reveal:function(b,c){a(document).trigger("beforeReveal.facebox");
c&&a("#facebox .facebox_content").addClass(c);a("#facebox .facebox_content").append(b);a("#facebox .facebox_loading").remove();a("#facebox .facebox_body").children().fadeIn("normal");a("#facebox").animate({left:a(window).width()/2-a("#facebox table").width()/2,top:f()[1]+a(window).height()/2-a("#facebox table").height()/2},300);a(document).trigger("reveal.facebox").trigger("afterReveal.facebox")},close:function(){a(document).trigger("close.facebox");return!1}});a.fn.facebox=function(b){e(b);return this.click(function(){a.facebox.loading(!0);
var b=this.rel.match(/facebox\[?\.(\w+)\]?/);b&&(b=b[1]);g(this.href,b);return!1})};a(document).bind("close.facebox",function(){a(document).unbind("keydown.facebox");a("#facebox").fadeOut(function(){a("#facebox .facebox_content").removeClass().addClass("facebox_content");q();a("#facebox .facebox_loading").remove()})})})(jQuery);