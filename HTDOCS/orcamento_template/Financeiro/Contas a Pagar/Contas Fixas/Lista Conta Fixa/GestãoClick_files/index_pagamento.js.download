var tour,endTour;
$(document).ready(function() {
    tour = new Tour({
      onEnd: function() {
        endTour.restart();
      },
      steps: [
      {
        placement: 'bottom',
        element: '#botao-periodo',
        title: 'Período',
        content: 'Aqui você pode selecionar o período dos pagamentos. <br><b>Obs.:</b> Por padrão o sistema busca somente o mês atual podendo ser alterado pelo usuário.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.botao-busca-avancada',
        title: 'Busca avançada',
        content: 'Aqui você encontra funções mais avançadas para buscar os pagamentos como, entidade, descrição, plano de contas, período, valor, situação, conta bancária e forma de pagamento.',
        backdrop: true,
        onShown: function(tour) {
          var stepElement = getTourElement(tour);
          $(stepElement).after($('.tour-step-background'));
          $(stepElement).after($('.tour-backdrop'));
        },
      },
      {
        placement: 'right',
        element: '#botao-adicionar',
        title: 'Adicionar pagamento',
        content: 'Neste botão poderá cadastrar um novo pagamento. <br><b>Obs.:</b> Os pagamentos podem ser cadastrados manualmente através deste botão ou automáticamente através de uma compra quando confirmada pelo usuário.',
        backdrop: true,
      },
      {
        placement: 'right',
        element: '#botao-pagamento-fixo',
        title: 'Contas fixas',
        content: 'Neste botão poderá controlar suas contas fixas como aluguel, condomínio, mensalidades etc...',
        backdrop: true,
      },
      {
        placement: 'right',
        element: '#botao-acoes-massa',
        title: 'Mais ações',
        content: 'Neste botão poderá realizar ações como confirmar ou cancelar vários recebimentos, realizar transferências entre contas e exportar cadastros em formato excel.',
        backdrop: true,
        onNext: function() {
            if(!$('.index .btn-info:first').length){
                assistirVideoTutorial();
            }
        },
      },
      {
        placement: 'top',
        element: '.index tbody tr:first',
        title: 'Resumo do pagamento',
        content: 'Aqui você visualiza um resumo do pagamento.',
        backdrop: true,
      },
      {
        placement: 'bottom',
        element: '.index tbody span.label:first',
        title: 'Situação',
        content: 'Aqui você pode alterar a situação do pagamento.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.index .situacao:first',
        title: 'Situação',
        content: 'Neste botão poderá ativar e desativar a conta fixa.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.index .btn-info:first',
        title: 'Visualizar pagamento',
        content: 'Neste botão poderá visualizar os detalhes do pagamento.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.index .btn-warning:first',
        title: 'Editar pagamento',
        content: 'Neste botão poderá atualizar os dados do pagamento.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.index .btn-danger:first',
        title: 'Deletar pagamento',
        content: 'Neste botão poderá excluir o pagamento.',
        backdrop: true,
      },
      {
        placement: 'left',
        element: '.index .mais-acoes:first',
        title: 'Mais ações',
        content: 'Neste botão poderá realizar mais ações como Confirmar pagamento, Cancelar confirmação e imprimir recibo.',
        backdrop: true,
        onNext: function() {
            if($('.index .btn-info:first').length){
                if(exibirVideo){
                    assistirVideoTutorial();
                }else{
                    tour.end();
                    endTour.restart();
                    exibirVideo = true;
                }
            }
        },
      },
      {

      }
    ]});

    endTour = new Tour({
      steps: [
      {
        placement: 'left',
        element: '#start-tour',
        title: 'Passo-a-passo',
        content: 'Sempre que quiser ver este passo-a-passo, clique neste botão.',
        backdrop: true,
        onNext: function() {
          endTour.end();
        },
      },
      {

      }
    ]});

    $('.start-tour').click(function(){
        tour.restart();
    });

    $('.end-tour').click(function(){
        endTour.restart();
    });
});

function getTourElement(tour){
   return tour._options.steps[tour._current].element
}