var arrayRegioes = [];function carregarContatos(){hostWebService = "192.168.100.15";portaImgService = "8088";var waypts = [];var rotas = []; /* Fundamental para tracar as rotas */var indiceCor = 0;$.ajax({type: 'GET',url: urlWebService+"ViagemSimplesWs/listar"+parametrosWebService,contentType: "application/json",jsonpCallback: "localJsonpCallback"}).done( function(data){for(i in data){if (data[i].endEntrega.length > 0) {waypts = [];for (var j = 0; j < data[i].endEntrega.length; j++) {waypts.push({location: data[i].endEntrega[j].endEntrega, stopover: true});}/*console.log("\n\ndata[i].endEntrega");console.log(data[i].endEntrega);console.log("\n\n");*/indiceCor = arrayDeCores.length < i ? arrayDeCores.length - 1 : i-1;rotas.push({origem: data[i].endInicial,destino: data[i].endFinal,entregas: waypts,entregasDetalhe: data[i].endEntrega,rotaDetalhe: data[i],cor: arrayDeCores[indiceCor]});/* console.log(rotas[rotas.length - 1]) */}}tracarRotas(rotas);carregarRegioes();});}function carregarRegioes(){/* var cityCircle = null; *//* var Marker = null; */var arrayLatLng, latitude, longitude;var tabelaRegioes = "<table class='table'>";$.ajax({type: 'GET',url: urlWebService+"RegiaoWs/listar"+parametrosWebService,contentType: "application/json",jsonpCallback: "localJsonpCallback"}).done( function(data){for (i in data){arrayLatLng = data[i].lat_lng.split(",");/* console.log(arrayLatLng); */latitude = parseFloat(arrayLatLng[0]);longitude = parseFloat(arrayLatLng[1]);var cityCircle = new google.maps.Circle({strokeColor: 'black',strokeOpacity: 0.2,strokeWeight: 2,fillColor: 'lightblue',fillOpacity: 0.35,map: map,center: {lat: latitude,lng: longitude},radius: data[i].raio});/* Caracteristicas do evento */var contentString = retornarJanelaInfo(data[i].descricao);var infowindow = new google.maps.InfoWindow({content: contentString});var Marker = new google.maps.Marker({position: {lat: latitude, lng: longitude},map: map,icon: "img/region.png",title: data[i].descricao,evento: infowindow});tabelaRegioes += desenharLinhaRegiao("img/region.png", data[i].descricao, arrayRegioes.length);/* Adição da região ao marcador */arrayRegioes.push({regiao: cityCircle, ponto: Marker});setarRegioesMapa(map, false);}tabelaRegioes += "</table>";$("#regioesDemostrativo").html(tabelaRegioes);});}function desenharLinhaRegiao(imagem, descricao, indeceRegiao){var conteudo = "<tr onclick='delimitarRegioes("+indeceRegiao+")' id='linha_"+indeceRegiao+"' bgcolor='#5cb85c'>";conteudo += 	"<td>";conteudo += 		"<img src='"+imagem+"'>";conteudo += 	"</td>";conteudo += 	"<td>";conteudo += 		descricao;conteudo += 		"<input type='hidden' value='"+indeceRegiao+"' name='valorRegiao'>";conteudo += 		"<input type='checkbox' class='hidden' id='check_"+indeceRegiao+"' checked>";conteudo += 	"</td>";conteudo += 	"<td id='iconeRegiao_"+indeceRegiao+"'>";conteudo += 		"<i class='fa fa-check'></i>";conteudo += 	"</td>";conteudo += "</tr>";return conteudo;}function delimitarRegioes(indice){if(document.getElementById("check_"+indice).checked){document.getElementById("check_"+indice).checked = false;} else {document.getElementById("check_"+indice).checked = true;}redefinirCor();}function redefinirCor(){var regioes = document.getElementsByName("valorRegiao");for (var i = 0; i < regioes.length; i++) {if (document.getElementById("check_"+regioes[i].value).checked) {document.getElementById("iconeRegiao_"+regioes[i].value).innerHTML = "<i class='fa fa-check'></i>";document.getElementById("linha_"+regioes[i].value).style.backgroundColor = "#5cb85c";} else {document.getElementById("iconeRegiao_"+regioes[i].value).innerHTML = "<i class='fa fa-times'></i>";document.getElementById("linha_"+regioes[i].value).style.backgroundColor = "#d9534f";}}setarRegioesMapa(map, true);/* cores: d9534f , 5cb85c , 428bca */}/* var eventoDoMomento = null; */function setarRegioesMapa(map, verificar){for (var i = 0; i < arrayRegioes.length; i++) {if (verificar) {if (document.getElementById("check_"+i).checked) {arrayRegioes[i].regiao.setMap(map);arrayRegioes[i].ponto.setMap(map);/* eventoDoMomento = arrayRegioes[i].evento; */arrayRegioes[i].ponto.addListener('click', function() {if (this.aberto) {this.evento.close(map, this);this.aberto = false;}else {this.evento.open(map, this);this.aberto = true;}});} else {arrayRegioes[i].regiao.setMap(null);arrayRegioes[i].ponto.setMap(null);}} else {arrayRegioes[i].regiao.setMap(map);arrayRegioes[i].ponto.setMap(map);/* eventoDoMomento = arrayRegioes[i].evento; */arrayRegioes[i].ponto.addListener('click', function() {/* if (this.aberto) {this.evento.close(map, this);this.aberto = false;}else { */this.evento.open(map, this);this.aberto = true;/* } */});}}}function setarRotaExclusiva(cor){for (var i = 0; i < rotasCordenadas.length; i++) {rotasCordenadas[i].setMap(null);caminhaos[i].setarMapa = false;caminhaos[i].caminhao.setMap(null);for (var j = 0; j < arrayIndiceMarcador[i].length; j++) {MarcadoreEntregas[arrayIndiceMarcador[i][j]].Marker.setMap(null);}}var indece = document.getElementById("rota_"+cor).value;rotasCordenadas[indece].setMap(map);caminhaos[indece].setarMapa = true;caminhaos[indece].caminhao.setMap(map);for (var j = 0; j < arrayIndiceMarcador[indece].length; j++) {MarcadoreEntregas[arrayIndiceMarcador[indece][j]].Marker.setMap(map);}}function setarRegistroCaminhao(placa, motorista){var conteudo = "";conteudo += "<div class=\"col-xs-4 col-md-2\">";conteudo += 	"<img src=\"img/caminhao/icon.png\" width=\"100%\">";conteudo += "</div>";conteudo += "<div class=\"col-xs-4 col-md-2\">";conteudo += 	"<img src=\"img/motorista/icon.png\" width=\"100%\">";conteudo += "</div>";conteudo += "<div class=\"col-xs-4 col-md-8\">";conteudo +=		"<table class=\"table\">";conteudo += 		"<tr>";conteudo += 			"<td>";conteudo += 				"<b>Caminhao: </b>";conteudo += 			"</td>";conteudo += 			"<td>";conteudo += 				placa;conteudo += 			"</td>";conteudo += 		"</tr>";conteudo += 		"<tr>";conteudo += 			"<td>";conteudo += 				"<b>Motorista: </b>";conteudo += 			"</td>";conteudo += 			"<td>";conteudo += 				motorista;conteudo += 			"</td>";conteudo += 		"</tr>";conteudo += 		"<tr>";conteudo += 			"<td>";conteudo += 				"<b>Telefone: </b>";conteudo += 			"</td>";conteudo += 			"<td>";conteudo += 				"9999-9999";conteudo += 			"</td>";conteudo += 		"</tr>";conteudo += 	"</table>";conteudo += "</div>";$("#conteudoInfGeralCaminhao").html(conteudo);}function imprimiMapa(){/* Salva status */var divImagensLogos = document.getElementById("divImagensLogos").style.display;var voltarConteudoRotas = document.getElementById("voltarConteudoRotas").style.display;var conteudoRotas = document.getElementById("conteudoRotas").style.display;var voltarConteudoRegiao = document.getElementById("voltarConteudoRegiao").style.display;var conteudoRegiao = document.getElementById("conteudoRegiao").style.display;/* Oculta tudo */document.getElementById("divImagensLogos").style.display = "none";document.getElementById("voltarConteudoRotas").style.display = "none";document.getElementById("conteudoRotas").style.display = "none";document.getElementById("voltarConteudoRegiao").style.display = "none";document.getElementById("conteudoRegiao").style.display = "none";/* Manda Imprimir */window.print();/* Retorna tudo na sua condição inicial */document.getElementById("divImagensLogos").style.display = divImagensLogos;document.getElementById("voltarConteudoRotas").style.display = voltarConteudoRotas;document.getElementById("conteudoRotas").style.display = conteudoRotas;document.getElementById("voltarConteudoRegiao").style.display = voltarConteudoRegiao;document.getElementById("conteudoRegiao").style.display = conteudoRegiao;}