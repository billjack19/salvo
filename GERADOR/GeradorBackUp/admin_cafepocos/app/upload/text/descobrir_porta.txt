DECLARE @tcp_port nvarchar(5)
 
EXEC xp_regread
@rootkey    =    'HKEY_LOCAL_MACHINE',
@key        =    'SOFTWARE\MICROSOFT\MSSQLSERVER\MSSQLSERVER\SUPERSOCKETNETLIB\TCP',
@value_name    =    'TcpPort',
@value        =    @tcp_port OUTPUT
 
select @tcp_port

/*-------------------------------*/

Informação Banco de Dados SQL Serve:


SELECT @@SERVERNAME AS ServerName, @@SERVICENAME AS ServiceName

DECLARE @value VARCHAR(20)
DECLARE @key VARCHAR(100)

IF ISNULL(CHARINDEX('\', @@SERVERNAME, 0), 0) > 0
BEGIN

SET @key = 'SOFTWARE\Microsoft\Microsoft SQL Server\' +
   @@servicename +
   '\MSSQLServer\SuperSocketNetLib\Tcp'

END
ELSE
BEGIN

SET @key = 'SOFTWARE\MICROSOFT\MSSQLSERVER\MSSQLSERVER\SUPERSOCKETNETLIB\TCP'

END

SELECT @KEY as [Key]
EXEC master..xp_regread
   @rootkey = 'HKEY_LOCAL_MACHINE',
   @key = @key,
   @value_name = 'TcpPort',
   @value = @value OUTPUT

SELECT 'Port Number : ' + CAST(@value AS VARCHAR(5)) AS PortNumber